100 REM *****************************************************************
110 REM *                                                               *
120 REM *                    SUPER STAR TREK                            *
130 REM *                                                               *
140 REM *****************************************************************
150 PRINT "                                    ,------*------,"
160 PRINT "                    ,-------------   '---  ------'"
170 PRINT "                     '-------- --'      / /"
180 PRINT "                         ,---' '-------/ /--,"
190 PRINT "                          '----------------'"
200 PRINT "                     THE USS ENTERPRISE --- NCC-1701"
210 PRINT
220 PRINT
230 PRINT
240 REM INITIALIZATION
250 Z$="                         "
260 K9=0 : B9=0 : S9=0 : D0=0 : E0=3000 : E=E0 : P=10 : S=0 : T=0
270 T0=T : T9=30 : D1=0 : K7=0 : C2=0 : C3=0 : C4=0 : C5=0 : C6=0
280 REM SETUP GALAXY
290 FOR I=1 TO 8 : FOR J=1 TO 8 : G(I,J)=0 : NEXT J : NEXT I
300 K3=0 : B3=0 : S3=0
310 FOR I=1 TO 8 : FOR J=1 TO 8
320 K=0 : R=RND(1) : IF R>.98 THEN K=3 : K3=K3+3 : GOTO 360
330 IF R>.95 THEN K=2 : K3=K3+2 : GOTO 360
340 IF R>.80 THEN K=1 : K3=K3+1
350 B=0 : R=RND(1) : IF R>.96 THEN B=1 : B3=B3+1
360 S=0 : R=RND(1) : IF R>.90 THEN S=1 : S3=S3+1
370 G(I,J)=K*100+B*10+S
380 NEXT J : NEXT I
390 IF K3>0 THEN 420
400 REM ENSURE AT LEAST ONE KLINGON
410 G(RND(8)+1,RND(8)+1)=100 : K3=1
420 PRINT "YOUR ORDERS ARE AS FOLLOWS:"
430 PRINT "   DESTROY THE " K3 " KLINGON WARSHIPS WHICH HAVE INVADED"
440 PRINT "   THE GALAXY BEFORE THEY CAN ATTACK FEDERATION HEADQUARTERS"
450 PRINT "   ON STARDATE " T0+T9 "."
460 PRINT "   THIS GIVES YOU " T9 " DAYS. THERE ARE " B3 " STARBASES."
470 PRINT
500 REM MAIN COMMAND LOOP
510 PRINT "COMMAND";
520 INPUT A
530 IF A=1 THEN GOSUB 1000
540 IF A=2 THEN GOSUB 2000
550 IF A=3 THEN GOSUB 3000
560 IF A=4 THEN GOSUB 4000
570 IF A=5 THEN GOSUB 5000
580 IF A=6 THEN GOSUB 6000
590 GOTO 500
1000 REM SHORT RANGE SCAN
1010 PRINT "SHORT RANGE SCAN"
1020 FOR I=S1-1 TO S1+1
1030 FOR J=S2-1 TO S2+1
1040 IF I<1 OR I>8 OR J<1 OR J>8 THEN PRINT "***"; : GOTO 1060
1050 PRINT Q$(I,J);
1060 NEXT J : PRINT : NEXT I
1070 RETURN
2000 REM LONG RANGE SCAN
2010 PRINT "LONG RANGE SCAN"
2020 FOR I=Q1-1 TO Q1+1
2030 FOR J=Q2-1 TO Q2+1
2040 PRINT G(I,J);
2050 NEXT J : PRINT : NEXT I
2060 RETURN
3000 REM PHASERS
3010 PRINT "PHASERS LOCKED"
3020 INPUT "ENERGY TO FIRE"; X
3030 IF E<X THEN PRINT "INSUFFICIENT ENERGY" : RETURN
3040 E=E-X
3050 IF K3=0 THEN PRINT "NO ENEMY SHIPS" : RETURN
3060 PRINT "FIRING PHASERS..."
3070 REM HIT CALCULATION LOGIC HERE
3080 RETURN
4000 REM PHOTON TORPEDOES
4100 PRINT "TORPEDO TRACK"
4110 INPUT "COURSE (1-9)"; C1
4120 IF P=0 THEN PRINT "ALL TORPEDOES EXPENDED" : RETURN
4130 P=P-1
4140 PRINT "TORPEDO FIRED"
4150 REM MOVEMENT LOGIC HERE
4160 RETURN
5000 REM SHIELD CONTROL
5010 PRINT "SHIELD ENERGY IS " S
5020 INPUT "ENERGY TO TRANSFER TO SHIELDS"; X
5030 IF X+S > E+S THEN PRINT "INSUFFICIENT ENERGY" : RETURN
5040 E=E+S-X : S=X
5050 PRINT "SHIELDS SET TO " S
5060 RETURN
6000 REM LIBRARY COMPUTER
6010 INPUT "COMPUTER ACTIVE"; A
6020 IF A=0 THEN PRINT "FUNCTIONS AVAILABLE: 1=CUMULATIVE GALACTIC REPORT"
6030 IF A=1 THEN PRINT "KLINGONS REMAINING: " K3
6040 RETURN
9000 REM END GAME
9010 PRINT "GAME OVER"
9020 STOP
